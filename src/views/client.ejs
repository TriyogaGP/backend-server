<html>
    <head>
        <title>Client</title>
    </head>
    <body>
      <div style="text-align: center;">
        <h2 style="font-size: 20px;">STREAMING CAMERA</h2>
        <img src="">
        <input type="hidden" id="ipaddress" value="<%= ipaddress %>" />
        <input type="hidden" id="port" value="<%= port %>" />
        <script>
          const ipaddress = document.getElementById('ipaddress').value;
          const port = document.getElementById('port').value;
          console.log(ipaddress, port);
          
          const img = document.querySelector('img');
          const WS_URL = 'ws:///'+ ipaddress +':'+ port;
          const ws = new WebSocket(WS_URL);
          let urlObject;
          ws.onopen = () => console.log(`Connected to ${WS_URL}`);
          ws.onmessage = message => {
              const arrayBuffer = message.data;
              if(urlObject){
                  URL.revokeObjectURL(urlObject);
              }
              urlObject = URL.createObjectURL(new Blob([arrayBuffer]));
              img.src = urlObject;
          }
        </script>
      </div>
    </body>
</html>